<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AwardJet - Unlock the Full Value of Your Points</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://js.stripe.com/v3/"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { 50: '#f0f9ff', 100: '#e0f2fe', 200: '#bae6fd', 300: '#7dd3fc', 400: '#38bdf8', 500: '#0ea5e9', 600: '#0284c7', 700: '#0369a1', 800: '#075985', 900: '#0c4a6e' },
                        accent: { 400: '#fb923c', 500: '#f97316', 600: '#ea580c' }
                    },
                    fontFamily: { sans: ['Plus Jakarta Sans', 'system-ui', 'sans-serif'] }
                }
            }
        }
    </script>
    <style>
        * { font-family: 'Plus Jakarta Sans', system-ui, sans-serif; }
        .gradient-brand { background: linear-gradient(135deg, #0ea5e9 0%, #0369a1 50%, #0c4a6e 100%); }
        .gradient-accent { background: linear-gradient(135deg, #f97316 0%, #ea580c 100%); }
        .gradient-hero { background: linear-gradient(135deg, #0c4a6e 0%, #0369a1 50%, #0ea5e9 100%); }
        .gradient-gold { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .card-hover { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .card-hover:hover { transform: translateY(-4px); box-shadow: 0 25px 50px -12px rgba(0,0,0,0.15); }
        .tab-active { background: linear-gradient(135deg, #0ea5e9 0%, #0369a1 100%); color: white; }
        .fade-up { animation: fadeUp 0.5s ease-out forwards; opacity: 0; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse-glow { 0%, 100% { box-shadow: 0 0 20px rgba(14, 165, 233, 0.3); } 50% { box-shadow: 0 0 40px rgba(14, 165, 233, 0.6); } }
        .pulse-glow { animation: pulse-glow 2s ease-in-out infinite; }
        .value-excellent { color: #10b981; }
        .value-good { color: #0ea5e9; }
        .value-fair { color: #f59e0b; }
        .program-badge { width: 44px; height: 44px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 11px; color: white; }
        .modal-backdrop { background: rgba(12, 74, 110, 0.8); backdrop-filter: blur(8px); }
        .portfolio-card { transition: all 0.2s ease; }
        .portfolio-card:hover { transform: scale(1.02); }
        .balance-input::-webkit-inner-spin-button { -webkit-appearance: none; }
        .progress-ring { transform: rotate(-90deg); }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">
    <!-- Promo Banner -->
    <div class="bg-orange-500 text-white text-center py-2.5 px-4">
        <span class="text-sm md:text-base">ðŸŽ‰ Launch Special: Get 50% off your first 3 months with code <strong class="font-bold">LAUNCH50</strong></span>
    </div>

    <!-- Nav -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 gradient-brand rounded-xl flex items-center justify-center shadow-lg shadow-brand-500/30">
                        <i class="fas fa-paper-plane text-white text-lg"></i>
                    </div>
                    <span class="text-xl font-bold text-slate-900">Award<span class="text-brand-600">Jet</span></span>
                    <span class="text-xs bg-slate-200 text-slate-600 px-2 py-0.5 rounded-full font-medium ml-1">BETA</span>
                </div>
                <div class="hidden md:flex items-center gap-8">
                    <a href="#features" class="text-slate-600 hover:text-brand-600 font-medium">Features</a>
                    <a href="#pricing" class="text-slate-600 hover:text-brand-600 font-medium">Pricing</a>
                </div>
                <div class="flex items-center gap-3">
                    <button onclick="openAuth('login')" id="login-btn" class="px-4 py-2 text-slate-600 hover:text-brand-600 font-medium">Log In</button>
                    <button onclick="openAuth('signup')" class="px-5 py-2.5 gradient-brand text-white rounded-xl font-semibold hover:shadow-lg transition-all">Start Free Trial</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero -->
    <section class="gradient-hero py-20 md:py-28 px-4">
        <div class="max-w-5xl mx-auto text-center text-white">
            <div class="inline-flex items-center gap-2 bg-white/10 backdrop-blur-sm rounded-full px-4 py-2 mb-8">
                <span class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></span>
                <span class="text-sm font-medium text-white/90">Trusted by 12,000+ points enthusiasts</span>
            </div>
            <h1 class="text-5xl md:text-6xl lg:text-7xl font-extrabold mb-6 leading-tight">
                Stop Wasting Your<br>
                <span class="text-cyan-300">Miles & Points</span>
            </h1>
            <p class="text-xl md:text-2xl text-white/80 mb-10 max-w-3xl mx-auto leading-relaxed">
                Search 15+ programs instantly. Find hidden sweet spots.<br>
                Book business class for the price of economy.
            </p>
            <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-10">
                <button onclick="openAuth('signup')" class="w-full sm:w-auto px-8 py-4 bg-white text-brand-700 rounded-xl font-bold text-lg hover:bg-slate-100 hover:shadow-xl transition-all flex items-center justify-center gap-2">
                    Start 7-Day Free Trial
                    <i class="fas fa-arrow-right"></i>
                </button>
                <button onclick="scrollToApp()" class="w-full sm:w-auto px-8 py-4 bg-white/10 backdrop-blur border border-white/20 text-white rounded-xl font-bold text-lg hover:bg-white/20 transition-all flex items-center justify-center gap-2">
                    <i class="fas fa-play"></i>
                    See It In Action
                </button>
            </div>
            <div class="flex flex-wrap items-center justify-center gap-6 text-sm text-white/70">
                <div class="flex items-center gap-2"><i class="fas fa-ban text-white/50"></i><span>No Charge for 7 Days</span></div>
                <div class="flex items-center gap-2"><i class="fas fa-clock text-white/50"></i><span>Cancel Anytime</span></div>
            </div>
        </div>
    </section>

    <!-- Partner Logos Bar -->
    <section class="bg-white border-b border-slate-200 py-6">
        <div class="max-w-6xl mx-auto px-4">
            <p class="text-center text-slate-400 text-sm mb-4">Searching across all major loyalty programs</p>
            <div class="flex flex-wrap items-center justify-center gap-8 text-slate-400">
                <span class="font-semibold">United</span>
                <span class="font-semibold">American</span>
                <span class="font-semibold">Delta</span>
                <span class="font-semibold">Chase</span>
                <span class="font-semibold">Amex</span>
                <span class="font-semibold">British Airways</span>
                <span class="text-brand-600 font-semibold">+9 more</span>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="py-16 px-4 bg-gradient-to-b from-white to-slate-50">
        <div class="max-w-6xl mx-auto">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-slate-900 mb-4">Everything You Need to Maximize Your Points</h2>
                <p class="text-lg text-slate-600 max-w-2xl mx-auto">Powerful tools to search, track, and book award flights at the best value.</p>
            </div>
            <div class="grid md:grid-cols-3 gap-8">
                <div class="bg-white rounded-2xl p-6 shadow-lg border border-slate-200 hover:shadow-xl transition">
                    <div class="w-12 h-12 bg-brand-100 rounded-xl flex items-center justify-center mb-4">
                        <i class="fas fa-search text-brand-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Multi-Program Search</h3>
                    <p class="text-slate-600">Search 15+ airline and hotel programs simultaneously. Find the best redemption rates instantly.</p>
                </div>
                <div class="bg-white rounded-2xl p-6 shadow-lg border border-slate-200 hover:shadow-xl transition">
                    <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mb-4">
                        <i class="fas fa-wallet text-green-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Points Portfolio</h3>
                    <p class="text-slate-600">Track all your miles and points in one place. See your total value and get transfer suggestions.</p>
                </div>
                <div class="bg-white rounded-2xl p-6 shadow-lg border border-slate-200 hover:shadow-xl transition">
                    <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mb-4">
                        <i class="fas fa-bell text-purple-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Smart Alerts</h3>
                    <p class="text-slate-600">Get personalized trip ideas based on your points. Never miss a price drop or sweet spot deal.</p>
                </div>
                <div class="bg-white rounded-2xl p-6 shadow-lg border border-slate-200 hover:shadow-xl transition">
                    <div class="w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center mb-4">
                        <i class="fas fa-exchange-alt text-orange-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Transfer Partners</h3>
                    <p class="text-slate-600">See all transfer options from Chase, Amex, Capital One, and Citi to maximize your points value.</p>
                </div>
                <div class="bg-white rounded-2xl p-6 shadow-lg border border-slate-200 hover:shadow-xl transition">
                    <div class="w-12 h-12 bg-cyan-100 rounded-xl flex items-center justify-center mb-4">
                        <i class="fas fa-plane text-cyan-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Business Class Deals</h3>
                    <p class="text-slate-600">Find premium cabin sweet spots. Fly business class for fewer points than you'd expect.</p>
                </div>
                <div class="bg-white rounded-2xl p-6 shadow-lg border border-slate-200 hover:shadow-xl transition">
                    <div class="w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center mb-4">
                        <i class="fas fa-chart-line text-red-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Value Tracking</h3>
                    <p class="text-slate-600">Know exactly what your points are worth. Our valuations are based on real redemption data.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Main App -->
    <section class="py-12 px-4">
        <div class="max-w-7xl mx-auto">
            <div class="bg-white rounded-3xl shadow-2xl overflow-hidden border border-slate-200">
                <!-- Tabs -->
                <div class="flex border-b border-slate-200 bg-slate-50">
                    <button onclick="switchTab('search')" id="tab-search" class="flex-1 py-4 px-6 font-semibold text-center transition tab-active">
                        <i class="fas fa-search mr-2"></i>Flight Search
                    </button>
                    <button onclick="switchTab('portfolio')" id="tab-portfolio" class="flex-1 py-4 px-6 font-semibold text-center transition text-slate-600 hover:bg-slate-100">
                        <i class="fas fa-wallet mr-2"></i>Points Portfolio
                    </button>
                    <button onclick="switchTab('optimizer')" id="tab-optimizer" class="flex-1 py-4 px-6 font-semibold text-center transition text-slate-600 hover:bg-slate-100">
                        <i class="fas fa-chart-line mr-2"></i>Optimizer
                    </button>
                    <button onclick="switchTab('alerts')" id="tab-alerts" class="flex-1 py-4 px-6 font-semibold text-center transition text-slate-600 hover:bg-slate-100">
                        <i class="fas fa-bell mr-2"></i>Alerts
                    </button>
                </div>

                <div class="p-6 md:p-8">
                    <!-- Search Tab -->
                    <div id="content-search" class="tab-content">
                        <div class="max-w-4xl mx-auto">
                            <h2 class="text-2xl font-bold text-slate-900 mb-6 text-center">Find ALL Ways to Book Your Flight</h2>
                            <div class="bg-slate-50 rounded-2xl p-6 mb-6">
                                <div class="grid md:grid-cols-4 gap-4">
                                    <div>
                                        <label class="block text-sm font-semibold text-slate-700 mb-2">From</label>
                                        <input type="text" id="origin" value="MIA" class="w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 outline-none font-medium uppercase">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold text-slate-700 mb-2">To</label>
                                        <input type="text" id="destination" value="MAD" class="w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 outline-none font-medium uppercase">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold text-slate-700 mb-2">Date</label>
                                        <input type="date" id="travel-date" class="w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 outline-none font-medium">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold text-slate-700 mb-2">Class</label>
                                        <select id="cabin-class" class="w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 outline-none font-medium">
                                            <option value="business">Business</option>
                                            <option value="first">First Class</option>
                                            <option value="economy">Economy</option>
                                        </select>
                                    </div>
                                </div>
                                <button onclick="searchFlights()" class="w-full mt-6 gradient-brand text-white py-4 rounded-xl font-bold text-lg hover:shadow-lg transition-all">
                                    <i class="fas fa-search mr-2"></i>Search All Programs
                                </button>
                            </div>
                        </div>
                        <div id="search-results" class="mt-8 hidden">
                            <div class="flex items-center justify-between mb-6">
                                <h3 class="text-xl font-bold text-slate-900"><span id="result-route">MIA â†’ MAD</span> <span class="text-brand-600" id="result-count"></span></h3>
                            </div>
                            <div id="results-list" class="space-y-4"></div>
                        </div>
                    </div>

                    <!-- Portfolio Tab -->
                    <div id="content-portfolio" class="tab-content hidden">
                        <div class="max-w-5xl mx-auto">
                            <!-- Portfolio Header -->
                            <div class="text-center mb-8">
                                <h2 class="text-2xl font-bold text-slate-900 mb-2">Your Points Portfolio</h2>
                                <p class="text-slate-500">Track all your points & miles in one place. See your total value instantly.</p>
                            </div>

                            <!-- Total Value Card -->
                            <div class="gradient-brand rounded-3xl p-8 mb-8 text-white relative overflow-hidden">
                                <div class="absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2"></div>
                                <div class="absolute bottom-0 left-0 w-48 h-48 bg-white/5 rounded-full translate-y-1/2 -translate-x-1/2"></div>
                                <div class="relative z-10">
                                    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6">
                                        <div>
                                            <p class="text-white/70 text-sm font-medium mb-1">TOTAL PORTFOLIO VALUE</p>
                                            <div class="flex items-baseline gap-2">
                                                <span id="total-value" class="text-5xl md:text-6xl font-extrabold">$0</span>
                                                <span class="text-white/60 text-lg">estimated</span>
                                            </div>
                                            <p class="text-white/70 mt-2"><span id="total-points">0</span> total points across <span id="program-count">0</span> programs</p>
                                        </div>
                                        <div class="flex flex-col items-end gap-2">
                                            <div class="bg-white/20 backdrop-blur rounded-2xl px-6 py-4 text-center">
                                                <p class="text-white/70 text-xs mb-1">AVG VALUE</p>
                                                <p id="avg-cpp" class="text-2xl font-bold">0Â¢<span class="text-sm font-normal">/pt</span></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Quick Add Section -->
                            <div class="bg-slate-50 rounded-2xl p-6 mb-8">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="font-bold text-slate-900">Add Your Points</h3>
                                    <button onclick="clearAllBalances()" class="text-sm text-slate-500 hover:text-red-500 transition">
                                        <i class="fas fa-trash-alt mr-1"></i>Clear All
                                    </button>
                                </div>

                                <!-- Credit Card Points -->
                                <div class="mb-6">
                                    <p class="text-sm font-semibold text-slate-600 mb-3 flex items-center gap-2">
                                        <i class="fas fa-credit-card text-brand-500"></i>
                                        Credit Card Points (Transferable)
                                    </p>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#117ACA] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/chase/white" alt="Chase" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>CSP</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">Chase UR</p>
                                                    <p class="text-xs text-slate-500">~2Â¢/pt value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-chase" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#006FCF] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/americanexpress/white" alt="Amex" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>MR</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">Amex MR</p>
                                                    <p class="text-xs text-slate-500">~2Â¢/pt value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-amex" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#D12124] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/capitalone/white" alt="Capital One" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>C1</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">Capital One</p>
                                                    <p class="text-xs text-slate-500">~1.7Â¢/pt value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-capital" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#003A70] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/citi/white" alt="Citi" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>CITI</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">Citi TYP</p>
                                                    <p class="text-xs text-slate-500">~1.5Â¢/pt value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-citi" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                    </div>
                                </div>

                                <!-- Airline Miles -->
                                <div class="mb-6">
                                    <p class="text-sm font-semibold text-slate-600 mb-3 flex items-center gap-2">
                                        <i class="fas fa-plane text-brand-500"></i>
                                        Airline Miles
                                    </p>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#002244] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/unitedairlines/white" alt="United" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>UA</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">United</p>
                                                    <p class="text-xs text-slate-500">~1.2Â¢/mi value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-united" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#0078D2] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/americanairlines/white" alt="American" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>AA</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">American</p>
                                                    <p class="text-xs text-slate-500">~1.4Â¢/mi value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-american" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#003366] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/delta/white" alt="Delta" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>DL</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">Delta</p>
                                                    <p class="text-xs text-slate-500">~1.2Â¢/mi value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-delta" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#2E5C99] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/britishairways/white" alt="British Airways" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>BA</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">British Airways</p>
                                                    <p class="text-xs text-slate-500">~1.5Â¢/pt value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-british" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#C70A0C] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/turkishairlines/white" alt="Turkish" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>TK</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">Turkish</p>
                                                    <p class="text-xs text-slate-500">~1.8Â¢/mi value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-turkish" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#002157] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/airfrance/white" alt="Flying Blue" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>AF</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">Flying Blue</p>
                                                    <p class="text-xs text-slate-500">~1.3Â¢/mi value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-flyingblue" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#F0AB00] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/singaporeairlines/white" alt="Singapore" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>SQ</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">Singapore</p>
                                                    <p class="text-xs text-slate-500">~1.6Â¢/mi value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-singapore" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#13448F] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/ana/white" alt="ANA" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>NH</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">ANA</p>
                                                    <p class="text-xs text-slate-500">~1.5Â¢/mi value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-ana" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                    </div>
                                </div>

                                <!-- Hotel Points -->
                                <div>
                                    <p class="text-sm font-semibold text-slate-600 mb-3 flex items-center gap-2">
                                        <i class="fas fa-hotel text-brand-500"></i>
                                        Hotel Points
                                    </p>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#8B1E41] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/marriott/white" alt="Marriott" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>MR</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">Marriott</p>
                                                    <p class="text-xs text-slate-500">~0.8Â¢/pt value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-marriott" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#003A70] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/hilton/white" alt="Hilton" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>HH</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">Hilton</p>
                                                    <p class="text-xs text-slate-500">~0.5Â¢/pt value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-hilton" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#008080] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/ihg/white" alt="IHG" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>IHG</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">IHG</p>
                                                    <p class="text-xs text-slate-500">~0.5Â¢/pt value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-ihg" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                        <div class="portfolio-card bg-white rounded-xl p-4 border-2 border-slate-200 hover:border-brand-400">
                                            <div class="flex items-center gap-3 mb-3">
                                                <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-[#232A38] p-1.5">
                                                    <img src="https://cdn.simpleicons.org/hyatt/white" alt="Hyatt" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<span class=\'text-white font-bold text-xs\'>HY</span>'">
                                                </div>
                                                <div>
                                                    <p class="font-semibold text-slate-900 text-sm">Hyatt</p>
                                                    <p class="text-xs text-slate-500">~1.7Â¢/pt value</p>
                                                </div>
                                            </div>
                                            <input type="number" id="balance-hyatt" placeholder="0"
                                                class="balance-input w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-right font-semibold text-lg focus:ring-2 focus:ring-brand-500 outline-none"
                                                onchange="updatePortfolio()" oninput="updatePortfolio()">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Portfolio Breakdown -->
                            <div id="portfolio-breakdown" class="hidden">
                                <h3 class="font-bold text-slate-900 mb-4">Portfolio Breakdown</h3>
                                <div class="grid md:grid-cols-2 gap-6">
                                    <!-- By Program Type -->
                                    <div class="bg-white rounded-2xl border border-slate-200 p-6">
                                        <h4 class="font-semibold text-slate-700 mb-4">By Category</h4>
                                        <div id="breakdown-by-type" class="space-y-3"></div>
                                    </div>
                                    <!-- Top Programs -->
                                    <div class="bg-white rounded-2xl border border-slate-200 p-6">
                                        <h4 class="font-semibold text-slate-700 mb-4">Your Top Programs</h4>
                                        <div id="top-programs" class="space-y-3"></div>
                                    </div>
                                </div>

                                <!-- Transfer Recommendations -->
                                <div class="mt-6 bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl border border-amber-200 p-6">
                                    <div class="flex items-start gap-4">
                                        <div class="w-12 h-12 gradient-gold rounded-xl flex items-center justify-center flex-shrink-0">
                                            <i class="fas fa-lightbulb text-white text-lg"></i>
                                        </div>
                                        <div>
                                            <h4 class="font-bold text-slate-900 mb-2">Smart Transfer Tip</h4>
                                            <p id="transfer-tip" class="text-slate-600">Add your points above to get personalized transfer recommendations!</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- What You Can Book -->
                                <div class="mt-6">
                                    <h3 class="font-bold text-slate-900 mb-4">What You Can Book Right Now</h3>
                                    <div id="bookable-flights" class="grid md:grid-cols-4 gap-4"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Optimizer Tab -->
                    <div id="content-optimizer" class="tab-content hidden">
                        <div class="max-w-4xl mx-auto text-center py-12">
                            <div class="w-20 h-20 bg-brand-100 rounded-full flex items-center justify-center mx-auto mb-6">
                                <i class="fas fa-lock text-brand-600 text-3xl"></i>
                            </div>
                            <h3 class="text-2xl font-bold text-slate-900 mb-2">Points Optimizer</h3>
                            <p class="text-slate-500 mb-6">Find the best value for your points - ranked by cents-per-point</p>
                            <button onclick="openAuth('signup')" class="px-8 py-4 gradient-brand text-white rounded-xl font-bold hover:shadow-lg transition-all">
                                Unlock with Pro - $10/month
                            </button>
                        </div>
                    </div>

                    <!-- Alerts Tab -->
                    <div id="content-alerts" class="tab-content hidden">
                        <div class="max-w-6xl mx-auto">
                            <!-- Alerts Header -->
                            <div class="text-center mb-8">
                                <h2 class="text-2xl font-bold text-slate-900 mb-2">Trip Ideas & Price Alerts</h2>
                                <p class="text-slate-500">Personalized trip recommendations based on your points. Get notified when prices drop!</p>
                            </div>

                            <!-- Portfolio Summary for Alerts -->
                            <div id="alerts-portfolio-summary" class="bg-gradient-to-r from-brand-600 to-brand-800 rounded-2xl p-6 mb-8 text-white">
                                <div class="flex flex-wrap items-center justify-between gap-4">
                                    <div>
                                        <p class="text-white/70 text-sm">YOUR POINTS POWER</p>
                                        <p class="text-3xl font-bold" id="alerts-total-value">$0</p>
                                        <p class="text-white/70 text-sm mt-1">in travel value across <span id="alerts-program-count">0</span> programs</p>
                                    </div>
                                    <div class="flex gap-3">
                                        <div class="bg-white/20 backdrop-blur rounded-xl px-4 py-3 text-center">
                                            <p class="text-2xl font-bold" id="alerts-trips-count">0</p>
                                            <p class="text-xs text-white/70">Trips Available</p>
                                        </div>
                                        <div class="bg-white/20 backdrop-blur rounded-xl px-4 py-3 text-center">
                                            <p class="text-2xl font-bold" id="alerts-active-count">0</p>
                                            <p class="text-xs text-white/70">Active Alerts</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- No Points Warning -->
                            <div id="no-points-warning" class="hidden bg-amber-50 border border-amber-200 rounded-2xl p-6 mb-8">
                                <div class="flex items-start gap-4">
                                    <div class="w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center flex-shrink-0">
                                        <i class="fas fa-exclamation-triangle text-amber-600 text-xl"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-slate-900 mb-1">Add Your Points First!</h4>
                                        <p class="text-slate-600 mb-3">To see personalized trip ideas, add your points balances in the Portfolio tab.</p>
                                        <button onclick="switchTab('portfolio')" class="px-4 py-2 bg-amber-500 text-white rounded-lg font-semibold hover:bg-amber-600 transition">
                                            <i class="fas fa-wallet mr-2"></i>Go to Portfolio
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Personalized Trip Ideas -->
                            <div id="trip-ideas-section" class="mb-8">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="text-xl font-bold text-slate-900">
                                        <i class="fas fa-magic text-brand-500 mr-2"></i>Trip Ideas For You
                                    </h3>
                                    <button onclick="refreshTripIdeas()" class="text-sm text-brand-600 hover:text-brand-700 font-medium">
                                        <i class="fas fa-sync-alt mr-1"></i>Refresh Ideas
                                    </button>
                                </div>
                                <div id="trip-ideas-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Trip cards will be inserted here -->
                                </div>
                            </div>

                            <!-- Active Alerts -->
                            <div id="active-alerts-section" class="mb-8">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="text-xl font-bold text-slate-900">
                                        <i class="fas fa-bell text-accent-500 mr-2"></i>Your Active Alerts
                                    </h3>
                                </div>
                                <div id="active-alerts-list" class="space-y-3">
                                    <!-- Active alerts will be inserted here -->
                                </div>
                                <div id="no-alerts-message" class="text-center py-8 text-slate-500">
                                    <i class="fas fa-bell-slash text-4xl mb-3 text-slate-300"></i>
                                    <p>No active alerts yet. Click "Set Alert" on any trip idea above!</p>
                                </div>
                            </div>

                            <!-- Recent Price Drops -->
                            <div class="mb-8">
                                <h3 class="text-xl font-bold text-slate-900 mb-4">
                                    <i class="fas fa-arrow-trend-down text-green-500 mr-2"></i>Recent Price Drops
                                </h3>
                                <div id="price-drops-list" class="grid md:grid-cols-2 gap-4">
                                    <!-- Price drop cards will be inserted here -->
                                </div>
                            </div>

                            <!-- Email Preferences -->
                            <div class="bg-slate-50 rounded-2xl p-6">
                                <h3 class="font-bold text-slate-900 mb-4">
                                    <i class="fas fa-envelope text-brand-500 mr-2"></i>Alert Preferences
                                </h3>
                                <div class="grid md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-semibold text-slate-700 mb-2">Email for Alerts</label>
                                        <input type="email" id="alert-email" placeholder="your@email.com"
                                            class="w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold text-slate-700 mb-2">Alert Frequency</label>
                                        <select id="alert-frequency" class="w-full px-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 outline-none">
                                            <option value="instant">Instant (as they happen)</option>
                                            <option value="daily" selected>Daily Digest</option>
                                            <option value="weekly">Weekly Summary</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="mt-4 flex flex-wrap gap-4">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" id="alert-price-drops" checked class="w-5 h-5 text-brand-600 rounded">
                                        <span class="text-slate-700">Price drop alerts</span>
                                    </label>
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" id="alert-trip-ideas" checked class="w-5 h-5 text-brand-600 rounded">
                                        <span class="text-slate-700">New trip ideas</span>
                                    </label>
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="checkbox" id="alert-expiring" checked class="w-5 h-5 text-brand-600 rounded">
                                        <span class="text-slate-700">Points expiring soon</span>
                                    </label>
                                </div>
                                <button onclick="saveAlertPreferences()" class="mt-4 px-6 py-3 gradient-brand text-white rounded-xl font-semibold hover:shadow-lg transition-all">
                                    <i class="fas fa-save mr-2"></i>Save Preferences
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Pricing Section -->
    <section id="pricing" class="py-16 px-4 bg-slate-900">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-3xl font-bold text-white text-center mb-12">Simple Pricing</h2>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-slate-800 rounded-2xl p-8 border border-slate-700">
                    <h3 class="text-xl font-bold text-white mb-2">Free</h3>
                    <div class="text-4xl font-bold text-white mb-6">$0<span class="text-slate-400 text-lg">/month</span></div>
                    <ul class="space-y-3 text-slate-300 mb-8">
                        <li><i class="fas fa-check text-slate-500 mr-2"></i>3 searches per day</li>
                        <li><i class="fas fa-check text-slate-500 mr-2"></i>Points Portfolio tracker</li>
                        <li><i class="fas fa-times text-slate-600 mr-2"></i><span class="text-slate-500">No optimizer</span></li>
                        <li><i class="fas fa-times text-slate-600 mr-2"></i><span class="text-slate-500">No alerts</span></li>
                    </ul>
                    <button class="w-full py-3 border border-slate-600 text-slate-300 rounded-xl font-semibold">Current Plan</button>
                </div>
                <div class="bg-white rounded-2xl p-8 relative">
                    <div class="absolute -top-3 left-1/2 -translate-x-1/2 bg-accent-500 text-white text-xs font-bold px-4 py-1 rounded-full">RECOMMENDED</div>
                    <h3 class="text-xl font-bold text-slate-900 mb-2">Pro</h3>
                    <div class="text-4xl font-bold text-slate-900 mb-6">$10<span class="text-slate-400 text-lg">/month</span></div>
                    <ul class="space-y-3 text-slate-700 mb-8">
                        <li><i class="fas fa-check text-green-500 mr-2"></i><strong>Unlimited</strong> searches</li>
                        <li><i class="fas fa-check text-green-500 mr-2"></i>Points Portfolio tracker</li>
                        <li><i class="fas fa-check text-green-500 mr-2"></i>Points optimizer</li>
                        <li><i class="fas fa-check text-green-500 mr-2"></i>Unlimited price alerts</li>
                    </ul>
                    <button onclick="handleSubscribe()" class="w-full py-3 gradient-brand text-white rounded-xl font-bold hover:shadow-lg transition-all">
                        Start 7-Day Free Trial
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Auth Modal -->
    <div id="auth-modal" class="fixed inset-0 modal-backdrop z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl max-w-md w-full overflow-hidden shadow-2xl relative max-h-[95vh] overflow-y-auto">
            <button onclick="closeAuth()" class="absolute top-4 right-4 w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center text-slate-500 hover:bg-slate-200 z-10">
                <i class="fas fa-times"></i>
            </button>
            <div class="gradient-hero p-6 text-center">
                <h3 class="text-2xl font-bold text-white" id="auth-title">Start Your Free Trial</h3>
                <p class="text-brand-200 mt-2" id="auth-subtitle">7 days free, then $10/month</p>
            </div>
            <div class="p-6">
                <form id="auth-form" onsubmit="handleAuth(event)">
                    <div class="space-y-4">
                        <div id="name-field">
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Full Name</label>
                            <input type="text" id="auth-name" placeholder="John Doe" class="w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 outline-none">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Email</label>
                            <input type="email" id="auth-email" placeholder="john@example.com" required class="w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 outline-none">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Password</label>
                            <input type="password" id="auth-password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required class="w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 outline-none">
                        </div>
                        <div id="card-section" class="pt-2">
                            <div class="flex items-center justify-between mb-2">
                                <label class="block text-sm font-semibold text-slate-700">Payment Method</label>
                                <div class="flex items-center gap-1">
                                    <i class="fab fa-cc-visa text-blue-600 text-lg"></i>
                                    <i class="fab fa-cc-mastercard text-orange-500 text-lg"></i>
                                    <i class="fab fa-cc-amex text-blue-400 text-lg"></i>
                                </div>
                            </div>
                            <div id="card-element" class="w-full px-4 py-3.5 border border-slate-200 rounded-xl bg-white"></div>
                            <div id="card-errors" class="text-red-500 text-sm mt-2 hidden"></div>
                            <div class="mt-3 p-3 bg-green-50 border border-green-200 rounded-xl">
                                <div class="flex items-start gap-2">
                                    <i class="fas fa-shield-alt text-green-600 mt-0.5"></i>
                                    <div class="text-sm text-green-800">
                                        <strong>You won't be charged today.</strong> Your free trial starts immediately. Cancel anytime before it ends and pay nothing.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="submit" id="auth-submit-btn" class="w-full mt-6 gradient-brand text-white py-4 rounded-xl font-bold text-lg hover:shadow-lg transition-all flex items-center justify-center gap-2">
                        <span id="submit-text">Start Free Trial</span>
                        <i id="submit-spinner" class="fas fa-spinner fa-spin hidden"></i>
                    </button>
                    <div id="trial-timeline" class="mt-4 text-center">
                        <p class="text-xs text-slate-500">
                            <i class="fas fa-calendar-check text-brand-500 mr-1"></i>Today: Full access unlocked
                            <span class="mx-2">â†’</span>
                            <i class="fas fa-bell text-amber-500 mr-1"></i>Day 5: Reminder email
                            <span class="mx-2">â†’</span>
                            <i class="fas fa-credit-card text-slate-400 mr-1"></i>Day 8: First charge
                        </p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Booking Modal -->
    <div id="booking-modal" class="fixed inset-0 modal-backdrop z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl max-w-xl w-full overflow-hidden shadow-2xl relative max-h-[90vh] overflow-y-auto">
            <button onclick="closeBookingModal()" class="absolute top-4 right-4 w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center text-slate-500 hover:bg-slate-200 z-10">
                <i class="fas fa-times"></i>
            </button>
            <div class="gradient-brand p-6">
                <h3 class="text-xl font-bold text-white">Book Your Award Flight</h3>
                <p class="text-brand-200 text-sm mt-1" id="booking-route-display"></p>
            </div>
            <div class="p-6">
                <div id="booking-details" class="mb-6"></div>
                <div class="bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6">
                    <div class="flex items-start gap-3">
                        <i class="fas fa-info-circle text-amber-500 mt-0.5"></i>
                        <div class="text-sm text-amber-800">
                            <strong>How it works:</strong> We'll open the airline's award booking page. You'll need to log in to your loyalty account to see availability and complete your booking.
                        </div>
                    </div>
                </div>
                <div id="booking-options" class="space-y-3"></div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast-container" class="fixed bottom-4 right-4 z-50 space-y-2"></div>

    <script>
        // ============================================
        // PORTFOLIO DATA & VALUATIONS
        // ============================================

        const programData = {
            // Credit Cards (transferable)
            chase: { name: 'Chase Ultimate Rewards', code: 'CSP', color: '#1e40af', cpp: 2.0, type: 'credit', transferable: true },
            amex: { name: 'Amex Membership Rewards', code: 'MR', color: '#059669', cpp: 2.0, type: 'credit', transferable: true },
            capital: { name: 'Capital One Miles', code: 'C1', color: '#dc2626', cpp: 1.7, type: 'credit', transferable: true },
            citi: { name: 'Citi ThankYou Points', code: 'CITI', color: '#1e293b', cpp: 1.5, type: 'credit', transferable: true },
            // Airlines
            united: { name: 'United MileagePlus', code: 'UA', color: '#1e40af', cpp: 1.2, type: 'airline' },
            american: { name: 'American AAdvantage', code: 'AA', color: '#0ea5e9', cpp: 1.4, type: 'airline' },
            delta: { name: 'Delta SkyMiles', code: 'DL', color: '#7c3aed', cpp: 1.2, type: 'airline' },
            british: { name: 'British Airways Avios', code: 'BA', color: '#1e3a8a', cpp: 1.5, type: 'airline' },
            turkish: { name: 'Turkish Miles&Smiles', code: 'TK', color: '#dc2626', cpp: 1.8, type: 'airline' },
            flyingblue: { name: 'Air France Flying Blue', code: 'AF', color: '#2563eb', cpp: 1.3, type: 'airline' },
            singapore: { name: 'Singapore KrisFlyer', code: 'SQ', color: '#f59e0b', cpp: 1.6, type: 'airline' },
            ana: { name: 'ANA Mileage Club', code: 'NH', color: '#0369a1', cpp: 1.5, type: 'airline' },
            // Hotels
            marriott: { name: 'Marriott Bonvoy', code: 'MR', color: '#991b1b', cpp: 0.8, type: 'hotel' },
            hilton: { name: 'Hilton Honors', code: 'HH', color: '#1e3a8a', cpp: 0.5, type: 'hotel' },
            ihg: { name: 'IHG One Rewards', code: 'IHG', color: '#d97706', cpp: 0.5, type: 'hotel' },
            hyatt: { name: 'World of Hyatt', code: 'HY', color: '#0d9488', cpp: 1.7, type: 'hotel' }
        };

        const sampleFlights = [
            // Flights bookable with various programs - with direct booking URLs
            { route: 'NYC â†’ Paris', program: 'Flying Blue', points: 29000, cabin: 'Business', value: '$2,800', type: 'flight', from: 'JFK', to: 'CDG', bookingUrl: 'https://www.airfrance.us/search/offers?pax=1:0:0:0:0:0:0:0&cabinClass=BUSINESS&activeConnection=0&connections=JFK-A:CDG-A' },
            { route: 'LA â†’ Tokyo', program: 'ANA', points: 75000, cabin: 'Business', value: '$5,500', type: 'flight', from: 'LAX', to: 'NRT', bookingUrl: 'https://www.ana.co.jp/en/us/book-plan/booking/flight-ticket-booking/' },
            { route: 'MIA â†’ Madrid', program: 'Turkish', points: 45000, cabin: 'Business', value: '$3,200', type: 'flight', from: 'MIA', to: 'MAD', bookingUrl: 'https://www.turkishairlines.com/en-us/flights/booking/?origin=MIA&destination=MAD' },
            { route: 'CHI â†’ London', program: 'British Airways', points: 50000, cabin: 'Business', value: '$3,000', type: 'flight', from: 'ORD', to: 'LHR', bookingUrl: 'https://www.britishairways.com/travel/redeem/execclub/_gf/en_us?eId=106019&tab_selected=redeem&from=ORD&to=LHR&cabin=J' },
            { route: 'SFO â†’ Sydney', program: 'United', points: 80000, cabin: 'Business', value: '$6,000', type: 'flight', from: 'SFO', to: 'SYD', bookingUrl: 'https://www.united.com/en/us/fsr/choose-flights?f=SFO&t=SYD&d=2025-03-15&tt=1&at=1&sc=7&px=1&taxng=1&newHP=True&clm=7&st=bestmatches' },
            { route: 'BOS â†’ Rome', program: 'Delta', points: 85000, cabin: 'Business', value: '$3,500', type: 'flight', from: 'BOS', to: 'FCO', bookingUrl: 'https://www.delta.com/flight-search/search?tripType=ONE_WAY&originCity=BOS&destinationCity=FCO&paxCount=1&cabinFareClass=BUSINESS' },
            // American Airlines sweet spots
            { route: 'NYC â†’ Tokyo', program: 'American', points: 60000, cabin: 'Business', value: '$4,500', type: 'flight', from: 'JFK', to: 'NRT', bookingUrl: 'https://www.aa.com/booking/find-flights?tripType=oneWay&locale=en_US&pax=1&adult=1&type=awardBooking&cabin=BUSINESS&orig=JFK&dest=NRT' },
            { route: 'DFW â†’ Hong Kong', program: 'American', points: 70000, cabin: 'Business', value: '$5,000', type: 'flight', from: 'DFW', to: 'HKG', bookingUrl: 'https://www.aa.com/booking/find-flights?tripType=oneWay&locale=en_US&pax=1&adult=1&type=awardBooking&cabin=BUSINESS&orig=DFW&dest=HKG' },
            { route: 'LAX â†’ Sydney', program: 'American', points: 55000, cabin: 'Business', value: '$4,200', type: 'flight', from: 'LAX', to: 'SYD', bookingUrl: 'https://www.aa.com/booking/find-flights?tripType=oneWay&locale=en_US&pax=1&adult=1&type=awardBooking&cabin=BUSINESS&orig=LAX&dest=SYD' },
            { route: 'MIA â†’ SÃ£o Paulo', program: 'American', points: 30000, cabin: 'Business', value: '$2,400', type: 'flight', from: 'MIA', to: 'GRU', bookingUrl: 'https://www.aa.com/booking/find-flights?tripType=oneWay&locale=en_US&pax=1&adult=1&type=awardBooking&cabin=BUSINESS&orig=MIA&dest=GRU' },
            // Delta sweet spots
            { route: 'ATL â†’ Amsterdam', program: 'Delta', points: 50000, cabin: 'Business', value: '$3,200', type: 'flight', from: 'ATL', to: 'AMS', bookingUrl: 'https://www.delta.com/flight-search/search?tripType=ONE_WAY&originCity=ATL&destinationCity=AMS&paxCount=1&cabinFareClass=BUSINESS' },
            { route: 'JFK â†’ Paris', program: 'Delta', points: 42000, cabin: 'Business', value: '$2,800', type: 'flight', from: 'JFK', to: 'CDG', bookingUrl: 'https://www.delta.com/flight-search/search?tripType=ONE_WAY&originCity=JFK&destinationCity=CDG&paxCount=1&cabinFareClass=BUSINESS' },
            { route: 'SEA â†’ Tokyo', program: 'Delta', points: 65000, cabin: 'Business', value: '$4,000', type: 'flight', from: 'SEA', to: 'HND', bookingUrl: 'https://www.delta.com/flight-search/search?tripType=ONE_WAY&originCity=SEA&destinationCity=HND&paxCount=1&cabinFareClass=BUSINESS' },
            // Chase/United sweet spots
            { route: 'EWR â†’ Frankfurt', program: 'United', points: 60000, cabin: 'Business', value: '$3,800', type: 'flight', from: 'EWR', to: 'FRA', bookingUrl: 'https://www.united.com/en/us/fsr/choose-flights?f=EWR&t=FRA&d=2025-03-15&tt=1&at=1&sc=7&px=1&taxng=1&newHP=True&clm=7' },
            { route: 'SFO â†’ Singapore', program: 'United', points: 70000, cabin: 'Business', value: '$5,200', type: 'flight', from: 'SFO', to: 'SIN', bookingUrl: 'https://www.united.com/en/us/fsr/choose-flights?f=SFO&t=SIN&d=2025-03-15&tt=1&at=1&sc=7&px=1&taxng=1&newHP=True&clm=7' },
            { route: 'ORD â†’ London', program: 'United', points: 45000, cabin: 'Business', value: '$2,900', type: 'flight', from: 'ORD', to: 'LHR', bookingUrl: 'https://www.united.com/en/us/fsr/choose-flights?f=ORD&t=LHR&d=2025-03-15&tt=1&at=1&sc=7&px=1&taxng=1&newHP=True&clm=7' },
            // Economy sweet spots
            { route: 'NYC â†’ London', program: 'British Airways', points: 13000, cabin: 'Economy', value: '$450', type: 'flight', from: 'JFK', to: 'LHR', bookingUrl: 'https://www.britishairways.com/travel/redeem/execclub/_gf/en_us?eId=106019&tab_selected=redeem&from=JFK&to=LHR&cabin=M' },
            { route: 'LAX â†’ Cancun', program: 'American', points: 15000, cabin: 'Economy', value: '$380', type: 'flight', from: 'LAX', to: 'CUN', bookingUrl: 'https://www.aa.com/booking/find-flights?tripType=oneWay&locale=en_US&pax=1&adult=1&type=awardBooking&cabin=ECONOMY&orig=LAX&dest=CUN' },
            { route: 'MIA â†’ Caribbean', program: 'Delta', points: 12000, cabin: 'Economy', value: '$350', type: 'flight', from: 'MIA', to: 'SJU', bookingUrl: 'https://www.delta.com/flight-search/search?tripType=ONE_WAY&originCity=MIA&destinationCity=SJU&paxCount=1&cabinFareClass=ECONOMY' },
            // Marriott Hotels - direct property links
            { route: 'Ritz-Carlton Kyoto', program: 'Marriott', points: 85000, cabin: '5 nights', value: '$4,500', type: 'hotel', bookingUrl: 'https://www.marriott.com/en-us/hotels/ukyrz-the-ritz-carlton-kyoto/overview/' },
            { route: 'St. Regis Maldives', program: 'Marriott', points: 100000, cabin: '5 nights', value: '$8,000', type: 'hotel', bookingUrl: 'https://www.marriott.com/en-us/hotels/mlexr-the-st-regis-maldives-vommuli-resort/overview/' },
            { route: 'W Barcelona', program: 'Marriott', points: 50000, cabin: '5 nights', value: '$2,200', type: 'hotel', bookingUrl: 'https://www.marriott.com/en-us/hotels/bcnwh-w-barcelona/overview/' },
            { route: 'JW Marriott Cancun', program: 'Marriott', points: 40000, cabin: '5 nights', value: '$1,800', type: 'hotel', bookingUrl: 'https://www.marriott.com/en-us/hotels/cunjw-jw-marriott-cancun-resort-and-spa/overview/' },
            { route: 'Westin Maui', program: 'Marriott', points: 60000, cabin: '5 nights', value: '$2,800', type: 'hotel', bookingUrl: 'https://www.marriott.com/en-us/hotels/hnmwi-the-westin-maui-resort-and-spa-kaanapali/overview/' },
            { route: 'Marriott Paris', program: 'Marriott', points: 35000, cabin: '5 nights', value: '$1,500', type: 'hotel', bookingUrl: 'https://www.marriott.com/en-us/hotels/parmc-paris-marriott-champs-elysees-hotel/overview/' },
            { route: 'Le MÃ©ridien Bora Bora', program: 'Marriott', points: 70000, cabin: '5 nights', value: '$3,500', type: 'hotel', bookingUrl: 'https://www.marriott.com/en-us/hotels/bobmd-le-meridien-bora-bora/overview/' },
            // Hyatt Hotels - direct property links
            { route: 'Park Hyatt Tokyo', program: 'Hyatt', points: 30000, cabin: '5 nights', value: '$3,000', type: 'hotel', bookingUrl: 'https://www.hyatt.com/en-US/hotel/japan/park-hyatt-tokyo/tyoph' },
            { route: 'Andaz Maui', program: 'Hyatt', points: 25000, cabin: '5 nights', value: '$2,500', type: 'hotel', bookingUrl: 'https://www.hyatt.com/en-US/hotel/hawaii/andaz-maui-at-wailea-resort/oggaw' },
            { route: 'Grand Hyatt NYC', program: 'Hyatt', points: 20000, cabin: '5 nights', value: '$1,800', type: 'hotel', bookingUrl: 'https://www.hyatt.com/en-US/hotel/new-york/grand-hyatt-new-york/nycgh' },
            // Hilton Hotels - direct property links
            { route: 'Conrad Maldives', program: 'Hilton', points: 95000, cabin: '5 nights', value: '$5,000', type: 'hotel', bookingUrl: 'https://www.hilton.com/en/hotels/mlaborci-conrad-maldives-rangali-island/' },
            { route: 'Waldorf Astoria Beverly Hills', program: 'Hilton', points: 80000, cabin: '5 nights', value: '$4,200', type: 'hotel', bookingUrl: 'https://www.hilton.com/en/hotels/laxbhwa-waldorf-astoria-beverly-hills/' },
            { route: 'Hilton Hawaiian Village', program: 'Hilton', points: 50000, cabin: '5 nights', value: '$1,500', type: 'hotel', bookingUrl: 'https://www.hilton.com/en/hotels/hnlhvhh-hilton-hawaiian-village-waikiki-beach-resort/' }
        ];

        // ============================================
        // PORTFOLIO FUNCTIONS
        // ============================================

        function getBalances() {
            const balances = {};
            for (const programId of Object.keys(programData)) {
                const input = document.getElementById(`balance-${programId}`);
                if (input) {
                    balances[programId] = parseInt(input.value) || 0;
                }
            }
            return balances;
        }

        function updatePortfolio() {
            const balances = getBalances();
            let totalPoints = 0;
            let totalValue = 0;
            let programCount = 0;

            const programValues = [];

            for (const [programId, balance] of Object.entries(balances)) {
                if (balance > 0) {
                    const program = programData[programId];
                    const value = (balance * program.cpp) / 100;
                    totalPoints += balance;
                    totalValue += value;
                    programCount++;
                    programValues.push({ id: programId, balance, value, program });
                }
            }

            // Update header stats
            document.getElementById('total-value').textContent = '$' + totalValue.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 });
            document.getElementById('total-points').textContent = totalPoints.toLocaleString();
            document.getElementById('program-count').textContent = programCount;

            const avgCpp = totalPoints > 0 ? (totalValue / totalPoints * 100).toFixed(1) : '0';
            document.getElementById('avg-cpp').innerHTML = avgCpp + 'Â¢<span class="text-sm font-normal">/pt</span>';

            // Show/hide breakdown section
            const breakdownSection = document.getElementById('portfolio-breakdown');
            if (programCount > 0) {
                breakdownSection.classList.remove('hidden');
                updateBreakdown(balances, programValues);
                updateTransferTip(balances);
                updateBookableFlights(balances);
            } else {
                breakdownSection.classList.add('hidden');
            }

            // Save to localStorage
            localStorage.setItem('awardjetPortfolio', JSON.stringify(balances));

            // Update alerts trip ideas when portfolio changes
            if (typeof generateTripIdeas === 'function') {
                generateTripIdeas();
            }
        }

        function updateBreakdown(balances, programValues) {
            // By type breakdown
            const byType = { credit: 0, airline: 0, hotel: 0 };
            const byTypeValue = { credit: 0, airline: 0, hotel: 0 };

            for (const { id, balance, value, program } of programValues) {
                byType[program.type] += balance;
                byTypeValue[program.type] += value;
            }

            const typeLabels = { credit: 'Credit Card Points', airline: 'Airline Miles', hotel: 'Hotel Points' };
            const typeColors = { credit: 'bg-blue-500', airline: 'bg-purple-500', hotel: 'bg-amber-500' };
            const totalValue = byTypeValue.credit + byTypeValue.airline + byTypeValue.hotel;

            let typeHTML = '';
            for (const type of ['credit', 'airline', 'hotel']) {
                if (byType[type] > 0) {
                    const pct = totalValue > 0 ? (byTypeValue[type] / totalValue * 100).toFixed(0) : 0;
                    typeHTML += `
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <div class="w-3 h-3 ${typeColors[type]} rounded-full"></div>
                                <span class="text-slate-700">${typeLabels[type]}</span>
                            </div>
                            <div class="text-right">
                                <span class="font-semibold text-slate-900">$${byTypeValue[type].toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                                <span class="text-slate-400 text-sm ml-2">${pct}%</span>
                            </div>
                        </div>
                    `;
                }
            }
            document.getElementById('breakdown-by-type').innerHTML = typeHTML;

            // Top programs
            programValues.sort((a, b) => b.value - a.value);
            let topHTML = '';
            for (const { id, balance, value, program } of programValues.slice(0, 5)) {
                topHTML += `
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-lg flex items-center justify-center text-white text-xs font-bold" style="background-color: ${program.color}">
                                ${program.code}
                            </div>
                            <div>
                                <span class="text-slate-700 text-sm">${program.name}</span>
                                <p class="text-xs text-slate-400">${balance.toLocaleString()} pts</p>
                            </div>
                        </div>
                        <span class="font-semibold text-slate-900">$${value.toLocaleString(undefined, {maximumFractionDigits: 0})}</span>
                    </div>
                `;
            }
            document.getElementById('top-programs').innerHTML = topHTML;
        }

        function updateTransferTip(balances) {
            const tips = [];

            if (balances.chase > 50000) {
                tips.push(`You have ${balances.chase.toLocaleString()} Chase points! Transfer to Hyatt for 1.7Â¢/pt value on hotel stays, or to United/British Airways for flights.`);
            }
            if (balances.amex > 50000) {
                tips.push(`Your ${balances.amex.toLocaleString()} Amex points can transfer 1:1 to ANA for amazing business class deals to Japan (75k pts roundtrip).`);
            }
            if (balances.marriott >= 60000) {
                tips.push(`With ${balances.marriott.toLocaleString()} Marriott points, you can transfer 60k â†’ 25k airline miles + 5k bonus to many partners!`);
            }
            if (balances.turkish > 0 && balances.turkish < 45000 && balances.chase > 0) {
                const needed = 45000 - balances.turkish;
                if (balances.chase >= needed) {
                    tips.push(`Transfer ${needed.toLocaleString()} Chase points to Turkish to reach 45,000 miles - enough for business class to Europe!`);
                }
            }
            if (balances.hyatt > 0) {
                tips.push(`Hyatt points are gold! At 1.7Â¢/pt average value, they're often worth more than transferring Chase to airlines.`);
            }

            const tipEl = document.getElementById('transfer-tip');
            if (tips.length > 0) {
                tipEl.textContent = tips[Math.floor(Math.random() * tips.length)];
            } else {
                tipEl.textContent = 'Add more points to get personalized transfer recommendations!';
            }
        }

        function updateBookableFlights(balances) {
            const totalTransferable = (balances.chase || 0) + (balances.amex || 0) + (balances.capital || 0) + (balances.citi || 0);
            const bookable = [];

            for (const flight of sampleFlights) {
                let canBook = false;
                let useProgram = '';

                // Hotel programs - direct booking
                if (flight.program === 'Marriott' && (balances.marriott || 0) >= flight.points) {
                    canBook = true;
                    useProgram = 'Marriott Bonvoy points';
                } else if (flight.program === 'Hyatt' && ((balances.hyatt || 0) >= flight.points || (balances.chase || 0) >= flight.points)) {
                    canBook = true;
                    useProgram = (balances.hyatt || 0) >= flight.points ? 'World of Hyatt points' : 'Transfer from Chase';
                } else if (flight.program === 'Hilton' && ((balances.hilton || 0) >= flight.points || (balances.amex || 0) >= flight.points)) {
                    canBook = true;
                    useProgram = (balances.hilton || 0) >= flight.points ? 'Hilton Honors points' : 'Transfer from Amex';
                }
                // Airline programs
                else if (flight.program === 'Flying Blue' && ((balances.flyingblue || 0) >= flight.points || totalTransferable >= flight.points)) {
                    canBook = true;
                    useProgram = (balances.flyingblue || 0) >= flight.points ? 'Flying Blue miles' : 'Transfer from Chase/Amex';
                } else if (flight.program === 'ANA' && ((balances.ana || 0) >= flight.points || (balances.amex || 0) >= flight.points)) {
                    canBook = true;
                    useProgram = (balances.ana || 0) >= flight.points ? 'ANA miles' : 'Transfer from Amex';
                } else if (flight.program === 'Turkish' && ((balances.turkish || 0) >= flight.points || (balances.citi || 0) >= flight.points || totalTransferable >= flight.points)) {
                    canBook = true;
                    useProgram = (balances.turkish || 0) >= flight.points ? 'Turkish miles' : 'Transfer from Citi/Capital One';
                } else if (flight.program === 'British Airways' && ((balances.british || 0) >= flight.points || totalTransferable >= flight.points)) {
                    canBook = true;
                    useProgram = (balances.british || 0) >= flight.points ? 'Avios' : 'Transfer from Chase/Amex';
                } else if (flight.program === 'United' && ((balances.united || 0) >= flight.points || (balances.chase || 0) >= flight.points)) {
                    canBook = true;
                    useProgram = (balances.united || 0) >= flight.points ? 'United miles' : 'Transfer from Chase';
                } else if (flight.program === 'Delta' && ((balances.delta || 0) >= flight.points || (balances.amex || 0) >= flight.points)) {
                    canBook = true;
                    useProgram = (balances.delta || 0) >= flight.points ? 'Delta miles' : 'Transfer from Amex';
                } else if (flight.program === 'American' && ((balances.american || 0) >= flight.points || (balances.citi || 0) >= flight.points || totalTransferable >= flight.points)) {
                    canBook = true;
                    useProgram = (balances.american || 0) >= flight.points ? 'AAdvantage miles' : 'Transfer from Citi/Marriott';
                } else if (flight.program === 'Singapore' && ((balances.singapore || 0) >= flight.points || totalTransferable >= flight.points)) {
                    canBook = true;
                    useProgram = (balances.singapore || 0) >= flight.points ? 'KrisFlyer miles' : 'Transfer from Chase/Amex/Citi';
                }

                if (canBook) {
                    bookable.push({ ...flight, useProgram });
                }
            }

            // Sort by value (highest first) and prioritize hotels for high Marriott balances
            bookable.sort((a, b) => {
                const aVal = parseInt(a.value.replace(/[^0-9]/g, ''));
                const bVal = parseInt(b.value.replace(/[^0-9]/g, ''));
                return bVal - aVal;
            });

            // Program logos mapping
            const programLogos = {
                'Flying Blue': { icon: 'https://cdn.simpleicons.org/airfrance/white', bg: '#002157' },
                'ANA': { icon: 'https://cdn.simpleicons.org/ana/white', bg: '#13448F' },
                'Turkish': { icon: 'https://cdn.simpleicons.org/turkishairlines/white', bg: '#C70A0C' },
                'British Airways': { icon: 'https://cdn.simpleicons.org/britishairways/white', bg: '#2E5C99' },
                'United': { icon: 'https://cdn.simpleicons.org/unitedairlines/white', bg: '#002244' },
                'Delta': { icon: 'https://cdn.simpleicons.org/delta/white', bg: '#003366' },
                'American': { icon: 'https://cdn.simpleicons.org/americanairlines/white', bg: '#0078D2' },
                'Singapore': { icon: 'https://cdn.simpleicons.org/singaporeairlines/white', bg: '#F0AB00' },
                'Marriott': { icon: 'https://cdn.simpleicons.org/marriott/white', bg: '#8B1E41' },
                'Hyatt': { icon: 'https://cdn.simpleicons.org/hyatt/white', bg: '#232A38' },
                'Hilton': { icon: 'https://cdn.simpleicons.org/hilton/white', bg: '#003A70' }
            };

            const container = document.getElementById('bookable-flights');
            if (bookable.length > 0) {
                const icon = (f) => f.type === 'hotel' ? 'fa-hotel' : 'fa-plane';
                const color = (f) => f.type === 'hotel' ? 'text-purple-600 bg-purple-50' : 'text-brand-600 bg-brand-50';
                const getLogo = (program) => programLogos[program] || { icon: '', bg: '#6366f1' };

                container.innerHTML = bookable.slice(0, 8).map((f, idx) => {
                    const logo = getLogo(f.program);
                    return `
                    <div class="bg-white rounded-xl border border-slate-200 p-4 card-hover">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center gap-2">
                                <div class="w-7 h-7 rounded-md flex items-center justify-center p-1" style="background-color: ${logo.bg}">
                                    <img src="${logo.icon}" alt="${f.program}" class="w-full h-full object-contain" onerror="this.style.display='none'">
                                </div>
                                <span class="text-xs font-semibold ${color(f)} px-2 py-1 rounded-full"><i class="fas ${icon(f)} mr-1"></i>${f.cabin}</span>
                            </div>
                            <span class="text-xs text-slate-500">${f.value}</span>
                        </div>
                        <h4 class="font-bold text-slate-900 mb-1">${f.route}</h4>
                        <p class="text-sm text-slate-500 mb-2">${f.points.toLocaleString()} ${f.program}</p>
                        <p class="text-xs text-emerald-600 font-medium mb-3"><i class="fas fa-check-circle mr-1"></i>${f.useProgram}</p>
                        <a href="${f.bookingUrl}" target="_blank" class="block w-full text-center py-2 px-3 text-xs font-semibold rounded-lg bg-green-500 text-white hover:bg-green-600 transition">
                            <i class="fas fa-external-link-alt mr-1"></i> Book Now
                        </a>
                    </div>
                `}).join('');
            } else {
                container.innerHTML = `
                    <div class="col-span-4 text-center py-8 text-slate-500">
                        <i class="fas fa-plane-slash text-4xl mb-3 text-slate-300"></i>
                        <p>Add points to see what you can book!</p>
                    </div>
                `;
            }
        }

        function clearAllBalances() {
            for (const programId of Object.keys(programData)) {
                const input = document.getElementById(`balance-${programId}`);
                if (input) input.value = '';
            }
            updatePortfolio();
            showToast('Portfolio cleared', 'info');
        }

        function loadSavedPortfolio() {
            const saved = localStorage.getItem('awardjetPortfolio');
            if (saved) {
                const balances = JSON.parse(saved);
                for (const [programId, balance] of Object.entries(balances)) {
                    const input = document.getElementById(`balance-${programId}`);
                    if (input && balance > 0) {
                        input.value = balance;
                    }
                }
                updatePortfolio();
            }
        }

        // ============================================
        // AIRLINE BOOKING URLs
        // ============================================

        const AIRLINE_URLS = {
            'united': { name: 'United MileagePlus', buildUrl: (o, d, date, cabin) => `https://www.united.com/en/us/fsr/choose-flights?f=${o}&t=${d}&d=${date}&tt=1&at=1&sc=${cabin === 'first' ? '3' : cabin === 'business' ? '2' : '1'}&px=1&taxng=1&newHP=True&clm=7`, supportsDeepLink: true },
            'american': { name: 'American AAdvantage', buildUrl: (o, d, date) => `https://www.aa.com/booking/find-flights?tripType=oneWay&searchType=Award&locale=en_US&pax=1&adult=1&origin=${o}&destination=${d}&departDate=${date}`, supportsDeepLink: true },
            'delta': { name: 'Delta SkyMiles', buildUrl: (o, d, date) => `https://www.delta.com/flight-search/book-a-flight?tripType=ONE_WAY&priceType=Award&originCity=${o}&destinationCity=${d}&departureDate=${date}&paxCount=1`, supportsDeepLink: true },
            'turkish': { name: 'Turkish Miles&Smiles', buildUrl: () => `https://www.turkishairlines.com/en-int/miles-and-smiles/book-award-tickets/`, supportsDeepLink: false },
            'british': { name: 'British Airways Avios', buildUrl: () => `https://www.britishairways.com/travel/redeem/execclub/_gf/en_us`, supportsDeepLink: false },
            'airfrance': { name: 'Air France Flying Blue', buildUrl: (o, d, date) => `https://wwws.airfrance.us/search/offers?pax=1:0:0:0:0:0:0:0&cabinClass=BUSINESS&activeConnection=0&connections=${o}-A>${d}-A:${date}`, supportsDeepLink: true },
            'singapore': { name: 'Singapore KrisFlyer', buildUrl: () => `https://www.singaporeair.com/en_UK/ppsclub-krisflyer/redeem/`, supportsDeepLink: false },
            'ana': { name: 'ANA Mileage Club', buildUrl: () => `https://www.ana.co.jp/en/us/amc/award-reservation/`, supportsDeepLink: false },
            'chase': { name: 'Chase Ultimate Rewards', buildUrl: () => 'https://ultimaterewardspoints.chase.com/transfer-partners', supportsDeepLink: false },
            'amex': { name: 'Amex Membership Rewards', buildUrl: () => 'https://global.americanexpress.com/rewards/transfer', supportsDeepLink: false }
        };

        // ============================================
        // SEARCH & BOOKING
        // ============================================

        const loyaltyPrograms = {
            'chase': { name: 'Chase Ultimate Rewards', code: 'CSP', color: '#1a56db', logo: 'https://www.chase.com/etc/designs/chase-ux/favicon-152.png', transferPartners: ['united', 'british', 'airfrance', 'singapore'] },
            'amex': { name: 'Amex Membership Rewards', code: 'MR', color: '#059669', logo: 'https://www.aexp-static.com/cdaas/one/statics/axp-static-assets/2.14.1/package/dist/img/logos/dls-logo-line.svg', transferPartners: ['delta', 'british', 'airfrance', 'singapore', 'ana'] },
            'united': { name: 'United MileagePlus', ode: 'UA', color: '#1e40af', logo: 'https://images.kiwi.com/airlines/64/UA.png', airline: 'United Airlines' },
            'american': { name: 'American AAdvantage', code: 'AA', color: '#0ea5e9', logo: 'https://images.kiwi.com/airlines/64/AA.png', airline: 'American Airlines' },
            'delta': { name: 'Delta SkyMiles', code: 'DL', color: '#7c3aed', logo: 'https://images.kiwi.com/airlines/64/DL.png', airline: 'Delta Air Lines' },
            'british': { name: 'British Airways Avios', code: 'BA', color: '#1e3a8a', logo: 'https://images.kiwi.com/airlines/64/BA.png', airline: 'British Airways' },
            'airfrance': { name: 'Flying Blue', code: 'AF', color: '#2563eb', logo: 'https://images.kiwi.com/airlines/64/AF.png', airline: 'Air France' },
            'singapore': { name: 'KrisFlyer', code: 'SQ', color: '#f59e0b', logo: 'https://images.kiwi.com/airlines/64/SQ.png', airline: 'Singapore Airlines' },
            'ana': { name: 'ANA Mileage Club', code: 'NH', color: '#0369a1', logo: 'https://images.kiwi.com/airlines/64/NH.png', airline: 'ANA' },
            'turkish': { name: 'Miles&Smiles', code: 'TK', color: '#dc2626', logo: 'https://images.kiwi.com/airlines/64/TK.png', airline: 'Turkish Airlines' }
        };

        const awardCharts = {
            'united': { 'MIA-MAD': { economy: 30000, business: 70000, first: 110000 }, 'MIA-NRT': { economy: 35000, business: 80000, first: 120000 }, 'MIA-LHR': { economy: 30000, business: 70000, first: 110000 } },
            'american': { 'MIA-MAD': { economy: 22500, business: 57500, first: 85000 }, 'MIA-LHR': { economy: 22500, business: 57500, first: 85000 } },
            'british': { 'MIA-MAD': { economy: 13000, business: 50000, first: 68000 }, 'MIA-LHR': { economy: 26000, business: 60000, first: 80000 } },
            'airfrance': { 'MIA-MAD': { economy: 18000, business: 53000, first: 84000 }, 'MIA-CDG': { economy: 27500, business: 61000, first: 99000 } },
            'ana': { 'MIA-NRT': { economy: 35000, business: 75000, first: 105000 } },
            'turkish': { 'MIA-MAD': { economy: 15000, business: 45000, first: 67500 }, 'MIA-IST': { economy: 20000, business: 52500, first: 80000 } }
        };

        const cashPrices = { 'MIA-MAD': { economy: 800, business: 3500, first: 7000 }, 'MIA-NRT': { economy: 1200, business: 5500, first: 12000 }, 'MIA-LHR': { economy: 750, business: 3200, first: 6500 } };

        let userState = JSON.parse(localStorage.getItem('awardjetUser')) || { isLoggedIn: false, isPro: false };
        let currentAuthMode = 'signup';

        function searchFlights() {
            const origin = document.getElementById('origin').value.toUpperCase();
            const destination = document.getElementById('destination').value.toUpperCase();
            const date = document.getElementById('travel-date').value;
            const cabinClass = document.getElementById('cabin-class').value;
            const route = `${origin}-${destination}`;
            const results = [];

            for (const [programId, program] of Object.entries(loyaltyPrograms)) {
                if (awardCharts[programId]?.[route]) {
                    const points = awardCharts[programId][route][cabinClass];
                    if (points) {
                        const cashPrice = cashPrices[route]?.[cabinClass] || 3000;
                        results.push({ programId, program: program.name, code: program.code, color: program.color, points, cpp: (cashPrice / points * 100).toFixed(2), airline: program.airline, origin, destination, date, cabinClass, route });
                    }
                }
            }

            ['chase', 'amex'].forEach(bank => {
                loyaltyPrograms[bank].transferPartners.forEach(partner => {
                    if (awardCharts[partner]?.[route]) {
                        const points = awardCharts[partner][route][cabinClass];
                        if (points && !results.some(r => r.programId === partner && r.transferFrom === bank)) {
                            const cashPrice = cashPrices[route]?.[cabinClass] || 3000;
                            results.push({ programId: partner, program: loyaltyPrograms[partner].name, code: loyaltyPrograms[partner].code, color: loyaltyPrograms[partner].color, points, cpp: (cashPrice / points * 100).toFixed(2), airline: loyaltyPrograms[partner].airline, transferFrom: bank, transferFromName: loyaltyPrograms[bank].name, origin, destination, date, cabinClass, route });
                        }
                    }
                });
            });

            results.sort((a, b) => a.points - b.points);
            displayResults(results, origin, destination);
        }

        function displayResults(results, origin, dest) {
            document.getElementById('result-route').textContent = `${origin} â†’ ${dest}`;
            document.getElementById('result-count').textContent = `(${results.length} booking options)`;
            document.getElementById('results-list').innerHTML = results.map((r, i) => {
                const valueClass = r.cpp >= 3 ? 'value-excellent' : r.cpp >= 2 ? 'value-good' : 'value-fair';
                const airlineConfig = AIRLINE_URLS[r.programId];
                const deepLinkBadge = airlineConfig?.supportsDeepLink ? '<span class="ml-2 text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full">Route pre-filled</span>' : '';
                const logoUrl = loyaltyPrograms[r.programId]?.logo || '';
                return `
                    <div class="bg-white border border-slate-200 rounded-2xl p-5 card-hover fade-up" style="animation-delay: ${i * 0.05}s">
                        <div class="flex items-center justify-between flex-wrap gap-4">
                            <div class="flex items-center gap-4">
                                <div class="w-11 h-11 rounded-xl flex items-center justify-center overflow-hidden bg-white border border-slate-200 p-1">
                                    <img src="${logoUrl}" alt="${r.program}" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<div class=\\'program-badge\\' style=\\'background-color: ${r.color}\\'>${r.code}</div>'">
                                </div>
                                <div>
                                    <div class="font-bold text-slate-900">${r.program}${deepLinkBadge}</div>
                                    <div class="text-sm text-slate-500">${r.transferFrom ? `Transfer from ${r.transferFromName}` : `Book on ${r.airline}`}</div>
                                </div>
                            </div>
                            <div class="flex items-center gap-6">
                                <div class="text-right">
                                    <div class="text-2xl font-bold text-slate-900">${r.points.toLocaleString()}</div>
                                    <div class="text-sm text-slate-500">points</div>
                                </div>
                                <div class="text-right">
                                    <div class="text-lg font-bold ${valueClass}">${r.cpp}Â¢/pt</div>
                                    <div class="text-xs text-slate-400">value</div>
                                </div>
                                <button onclick='openBookingModal(${JSON.stringify(r).replace(/'/g, "&#39;")})' class="px-5 py-2.5 gradient-brand text-white rounded-xl font-semibold hover:shadow-lg transition-all">
                                    Book <i class="fas fa-external-link-alt ml-1 text-xs"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            document.getElementById('search-results').classList.remove('hidden');
        }

        function openBookingModal(result) {
            const airlineConfig = AIRLINE_URLS[result.programId];
            const logoUrl = loyaltyPrograms[result.programId]?.logo || '';
            document.getElementById('booking-route-display').textContent = `${result.origin} â†’ ${result.destination} â€¢ ${result.cabinClass.charAt(0).toUpperCase() + result.cabinClass.slice(1)} Class`;
            document.getElementById('booking-details').innerHTML = `
                <div class="flex items-center justify-between p-4 bg-slate-50 rounded-xl">
                    <div class="flex items-center gap-3">
                        <div class="w-11 h-11 rounded-xl flex items-center justify-center overflow-hidden bg-white border border-slate-200 p-1">
                            <img src="${logoUrl}" alt="${result.program}" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML='<div class=\\'program-badge\\' style=\\'background-color: ${result.color}\\'>${result.code}</div>'">
                        </div>
                        <div>
                            <div class="font-bold text-slate-900">${result.program}</div>
                            <div class="text-sm text-slate-500">${result.airline || result.program}</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-2xl font-bold text-slate-900">${result.points.toLocaleString()}</div>
                        <div class="text-sm text-slate-500">points needed</div>
                    </div>
                </div>
            `;
            const bookingUrl = airlineConfig.buildUrl(result.origin, result.destination, result.date, result.cabinClass);
            let optionsHTML = `
                <a href="${bookingUrl}" target="_blank" rel="noopener" class="block w-full gradient-brand text-white py-4 rounded-xl font-bold text-center hover:shadow-lg transition-all">
                    <i class="fas fa-plane-departure mr-2"></i>Open ${airlineConfig.name}<i class="fas fa-external-link-alt ml-2 text-xs opacity-70"></i>
                </a>
            `;
            if (result.transferFrom) {
                const transferConfig = AIRLINE_URLS[result.transferFrom];
                optionsHTML += `
                    <div class="border-t border-slate-200 pt-4 mt-4">
                        <p class="text-sm text-slate-600 mb-3"><strong>Step 1:</strong> Transfer ${result.points.toLocaleString()} points from ${result.transferFromName}</p>
                        <a href="${transferConfig.buildUrl()}" target="_blank" rel="noopener" class="block w-full py-3 border-2 border-brand-500 text-brand-700 rounded-xl font-semibold text-center hover:bg-brand-50 transition-all">
                            <i class="fas fa-exchange-alt mr-2"></i>Open ${result.transferFromName}
                        </a>
                    </div>
                `;
            }
            document.getElementById('booking-options').innerHTML = optionsHTML;
            document.getElementById('booking-modal').classList.remove('hidden');
        }

        function closeBookingModal() { document.getElementById('booking-modal').classList.add('hidden'); }

        // ============================================
        // AUTH & UI
        // ============================================

        function scrollToApp() {
            const appSection = document.querySelector('section.py-12');
            if (appSection) {
                appSection.scrollIntoView({ behavior: 'smooth' });
            }
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('[id^="tab-"]').forEach(el => { el.classList.remove('tab-active'); el.classList.add('text-slate-600'); });
            document.getElementById(`content-${tabName}`).classList.remove('hidden');
            document.getElementById(`tab-${tabName}`).classList.add('tab-active');
            document.getElementById(`tab-${tabName}`).classList.remove('text-slate-600');
        }

        function openAuth(mode) {
            currentAuthMode = mode;
            document.getElementById('auth-modal').classList.remove('hidden');
            const isSignup = mode === 'signup';
            document.getElementById('auth-title').textContent = isSignup ? 'Start Your Free Trial' : 'Welcome Back';
            document.getElementById('auth-subtitle').textContent = isSignup ? '7 days free, then $10/month' : 'Sign in to your account';
            document.getElementById('name-field').style.display = isSignup ? 'block' : 'none';
            document.getElementById('card-section').style.display = isSignup ? 'block' : 'none';
            document.getElementById('trial-timeline').style.display = isSignup ? 'block' : 'none';
            document.getElementById('submit-text').textContent = isSignup ? 'Start Free Trial' : 'Log In';
        }

        function closeAuth() { document.getElementById('auth-modal').classList.add('hidden'); }

        async function handleAuth(e) {
            e.preventDefault();
            const submitBtn = document.getElementById('auth-submit-btn');
            const submitText = document.getElementById('submit-text');
            const spinner = document.getElementById('submit-spinner');
            submitBtn.disabled = true;
            submitText.textContent = currentAuthMode === 'signup' ? 'Setting up...' : 'Signing in...';
            spinner.classList.remove('hidden');
            await new Promise(r => setTimeout(r, 1500));
            userState.isLoggedIn = true;
            userState.email = document.getElementById('auth-email').value;
            if (currentAuthMode === 'signup') userState.isPro = true;
            localStorage.setItem('awardjetUser', JSON.stringify(userState));
            document.getElementById('login-btn').innerHTML = `<i class="fas fa-user-circle mr-2"></i>${userState.email.split('@')[0]}`;
            showToast(currentAuthMode === 'signup' ? 'ðŸŽ‰ Welcome! Your trial has started.' : 'Welcome back!', 'success');
            closeAuth();
            submitBtn.disabled = false;
            submitText.textContent = currentAuthMode === 'signup' ? 'Start Free Trial' : 'Log In';
            spinner.classList.add('hidden');
        }

        function handleSubscribe() { openAuth('signup'); }

        function showToast(message, type = 'info') {
            const colors = { success: 'bg-green-600', warning: 'bg-amber-500', error: 'bg-red-500', info: 'bg-brand-600' };
            const toast = document.createElement('div');
            toast.className = `${colors[type]} text-white px-6 py-4 rounded-xl shadow-lg fade-up`;
            toast.innerHTML = message;
            document.getElementById('toast-container').appendChild(toast);
            setTimeout(() => toast.remove(), 4000);
        }

        // ============================================
        // ALERTS & TRIP IDEAS
        // ============================================

        // Trip ideas database - personalized based on points
        // Booking URLs for each program
        const bookingUrls = {
            marriott: 'https://www.marriott.com/search/submitSearch.mi',
            hyatt: 'https://www.hyatt.com/en-US/search',
            hilton: 'https://www.hilton.com/en/search/',
            united: 'https://www.united.com/en/us/book-flight/united-awards',
            american: 'https://www.aa.com/booking/search',
            delta: 'https://www.delta.com/flight-search/book-a-flight',
            ana: 'https://www.ana.co.jp/en/us/amc/partner-flight-awards/',
            flyingblue: 'https://www.airfrance.us/search/offers',
            turkish: 'https://www.turkishairlines.com/en-us/flights/booking/',
            chase: 'https://ultimaterewardspoints.chase.com',
            amex: 'https://global.americanexpress.com/rewards'
        };

        const tripIdeasDatabase = [
            // Marriott Hotel Trips
            { id: 'maldives-marriott', type: 'hotel', title: 'Maldives Overwater Villa', destination: 'Maldives', hotel: 'W Maldives', program: 'marriott', pointsNeeded: 85000, nightsMin: 5, cashValue: 4500, month: 'June', image: 'ðŸï¸', description: 'Overwater villa with private pool and stunning ocean views', category: 'Luxury Beach', bookingUrl: 'https://www.marriott.com/en-us/hotels/mlexw-w-maldives/overview/' },
            { id: 'bali-marriott', type: 'hotel', title: 'Bali Luxury Retreat', destination: 'Bali, Indonesia', hotel: 'The Ritz-Carlton Bali', program: 'marriott', pointsNeeded: 70000, nightsMin: 4, cashValue: 2800, month: 'July', image: 'ðŸŒ´', description: 'Cliffside suites with infinity pools overlooking the Indian Ocean', category: 'Luxury Beach', bookingUrl: 'https://www.marriott.com/en-us/hotels/dpsbr-the-ritz-carlton-bali/overview/' },
            { id: 'santorini-marriott', type: 'hotel', title: 'Santorini Sunset', destination: 'Santorini, Greece', hotel: 'Mystique Santorini', program: 'marriott', pointsNeeded: 60000, nightsMin: 3, cashValue: 2100, month: 'September', image: 'ðŸ‡¬ðŸ‡·', description: 'Cave suites with caldera views and private terraces', category: 'Romantic Getaway', bookingUrl: 'https://www.marriott.com/en-us/hotels/jtrsi-mystique-a-luxury-collection-hotel-santorini/overview/' },

            // Hyatt Hotel Trips
            { id: 'paris-hyatt', type: 'hotel', title: 'Paris Romance', destination: 'Paris, France', hotel: 'Park Hyatt Paris-VendÃ´me', program: 'hyatt', pointsNeeded: 30000, nightsMin: 3, cashValue: 2400, month: 'May', image: 'ðŸ—¼', description: 'Elegant rooms steps from Place VendÃ´me and the Louvre', category: 'City Luxury', bookingUrl: 'https://www.hyatt.com/en-US/hotel/france/park-hyatt-paris-vendome/parph' },
            { id: 'tokyo-hyatt', type: 'hotel', title: 'Tokyo Adventure', destination: 'Tokyo, Japan', hotel: 'Park Hyatt Tokyo', program: 'hyatt', pointsNeeded: 30000, nightsMin: 4, cashValue: 2000, month: 'April', image: 'ðŸ—¾', description: 'The iconic Lost in Translation hotel with stunning city views', category: 'City Luxury', bookingUrl: 'https://www.hyatt.com/en-US/hotel/japan/park-hyatt-tokyo/tyoph' },
            { id: 'maui-hyatt', type: 'hotel', title: 'Maui Beach Paradise', destination: 'Maui, Hawaii', hotel: 'Andaz Maui at Wailea', program: 'hyatt', pointsNeeded: 25000, nightsMin: 5, cashValue: 3500, month: 'October', image: 'ðŸŒº', description: 'Beachfront resort with incredible sunset views', category: 'Beach Resort', bookingUrl: 'https://www.hyatt.com/en-US/hotel/hawaii/andaz-maui-at-wailea-resort/oggaw' },

            // Hilton Hotel Trips
            { id: 'bora-hilton', type: 'hotel', title: 'Bora Bora Dream', destination: 'Bora Bora', hotel: 'Conrad Bora Bora', program: 'hilton', pointsNeeded: 120000, nightsMin: 4, cashValue: 5000, month: 'August', image: 'ðŸ ', description: 'Overwater bungalows with glass floor panels', category: 'Once in a Lifetime', bookingUrl: 'https://www.hilton.com/en/hotels/pptboci-conrad-bora-bora-nui/' },

            // Flight + Hotel Combos
            { id: 'japan-combo', type: 'combo', title: 'Japan Explorer', destination: 'Tokyo & Kyoto', flight: { program: 'ana', points: 75000, cabin: 'Business', route: 'US â†’ Tokyo' }, hotel: { program: 'hyatt', points: 25000, nights: 5, name: 'Park Hyatt Tokyo + Hyatt Regency Kyoto' }, totalValue: 8500, month: 'April', image: 'ðŸŽŒ', description: 'Cherry blossom season in business class + top hotels', category: 'Adventure', bookingUrl: 'https://www.ana.co.jp/en/us/amc/partner-flight-awards/' },
            { id: 'europe-combo', type: 'combo', title: 'European Escape', destination: 'Paris & Rome', flight: { program: 'flyingblue', points: 53000, cabin: 'Business', route: 'US â†’ Paris' }, hotel: { program: 'marriott', points: 50000, nights: 6, name: 'Renaissance Paris + St. Regis Rome' }, totalValue: 7200, month: 'June', image: 'âœˆï¸', description: 'Two iconic cities with business class comfort', category: 'Multi-City', bookingUrl: 'https://www.airfrance.us/search/offers' },
            { id: 'maldives-combo', type: 'combo', title: 'Maldives Ultimate', destination: 'Maldives', flight: { program: 'turkish', points: 45000, cabin: 'Business', route: 'US â†’ MalÃ©' }, hotel: { program: 'marriott', points: 85000, nights: 5, name: 'W Maldives' }, totalValue: 9500, month: 'February', image: 'ðŸŒŠ', description: 'Business class + overwater villa paradise', category: 'Honeymoon', bookingUrl: 'https://www.turkishairlines.com/en-us/flights/booking/' },

            // Flight-Only Ideas
            { id: 'australia-flight', type: 'flight', title: 'Australia Adventure', destination: 'Sydney', program: 'united', pointsNeeded: 80000, cabin: 'Business', cashValue: 6000, month: 'November', image: 'ðŸ¦˜', description: 'Lie-flat seats on the long haul down under', category: 'Long Haul', bookingUrl: 'https://www.united.com/en/us/book-flight/united-awards' },
            { id: 'hawaii-flight', type: 'flight', title: 'Hawaii Getaway', destination: 'Honolulu', program: 'american', pointsNeeded: 22500, cabin: 'Economy', cashValue: 600, month: 'December', image: 'ðŸ„', description: 'Quick escape to paradise at a great redemption rate', category: 'Quick Trip', bookingUrl: 'https://www.aa.com/booking/search' },
        ];

        // Price drop simulations (in production this would come from real data)
        const priceDrops = [
            { route: 'NYC â†’ Tokyo', program: 'ANA', oldPoints: 95000, newPoints: 75000, cabin: 'Business', date: 'March 15-22', savings: '$800 value', bookingUrl: 'https://www.ana.co.jp/en/us/amc/partner-flight-awards/' },
            { route: 'LAX â†’ Paris', program: 'Flying Blue', oldPoints: 70000, newPoints: 53000, cabin: 'Business', date: 'April 1-8', savings: '$600 value', bookingUrl: 'https://www.airfrance.us/search/offers' },
            { route: 'MIA â†’ London', program: 'British Airways', oldPoints: 75000, newPoints: 50000, cabin: 'Business', date: 'May 10-17', savings: '$750 value', bookingUrl: 'https://www.britishairways.com/travel/redeem/execclub/_gf/en_us' },
            { route: 'SFO â†’ Maldives', program: 'Turkish', oldPoints: 60000, newPoints: 45000, cabin: 'Business', date: 'June 5-12', savings: '$550 value', bookingUrl: 'https://www.turkishairlines.com/en-us/flights/booking/' },
        ];

        let activeAlerts = JSON.parse(localStorage.getItem('awardjetAlerts')) || [];

        function getMonthName(monthIndex) {
            return ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'][monthIndex];
        }

        function generateTripIdeas() {
            const balances = getBalances();
            const totalValue = Object.entries(balances).reduce((sum, [id, bal]) => {
                return sum + (bal * (programData[id]?.cpp || 1) / 100);
            }, 0);

            // Update summary
            document.getElementById('alerts-total-value').textContent = '$' + totalValue.toLocaleString(undefined, { maximumFractionDigits: 0 });
            document.getElementById('alerts-program-count').textContent = Object.values(balances).filter(b => b > 0).length;
            document.getElementById('alerts-active-count').textContent = activeAlerts.length;

            // Check if user has points
            const hasPoints = Object.values(balances).some(b => b > 0);
            document.getElementById('no-points-warning').classList.toggle('hidden', hasPoints);
            document.getElementById('trip-ideas-section').classList.toggle('hidden', !hasPoints);

            if (!hasPoints) {
                document.getElementById('alerts-trips-count').textContent = '0';
                return;
            }

            // Calculate which trips user can afford
            const affordableTrips = [];

            for (const trip of tripIdeasDatabase) {
                let canAfford = false;
                let pointsSource = [];
                let totalPointsNeeded = 0;

                if (trip.type === 'hotel') {
                    const hotelBalance = balances[trip.program] || 0;
                    const totalNeeded = trip.pointsNeeded * trip.nightsMin;
                    totalPointsNeeded = totalNeeded;

                    // Check direct balance or transferable points
                    if (hotelBalance >= totalNeeded) {
                        canAfford = true;
                        pointsSource.push(`${totalNeeded.toLocaleString()} ${programData[trip.program]?.name || trip.program}`);
                    } else if (trip.program === 'marriott' && hotelBalance > 0) {
                        // Partial Marriott
                        const remaining = totalNeeded - hotelBalance;
                        if (hotelBalance >= totalNeeded * 0.5) {
                            canAfford = true;
                            pointsSource.push(`${hotelBalance.toLocaleString()} Marriott + earn ${remaining.toLocaleString()} more`);
                        }
                    }
                } else if (trip.type === 'flight') {
                    const directBal = balances[trip.program] || 0;
                    totalPointsNeeded = trip.pointsNeeded;

                    // Check direct or transfer partners
                    if (directBal >= trip.pointsNeeded) {
                        canAfford = true;
                        pointsSource.push(`${trip.pointsNeeded.toLocaleString()} ${trip.program}`);
                    } else {
                        // Check transfer partners
                        const transferable = (balances.chase || 0) + (balances.amex || 0) + (balances.capital || 0);
                        if (transferable >= trip.pointsNeeded) {
                            canAfford = true;
                            if (balances.chase >= trip.pointsNeeded) pointsSource.push('Transfer from Chase');
                            else if (balances.amex >= trip.pointsNeeded) pointsSource.push('Transfer from Amex');
                            else pointsSource.push('Combine transferable points');
                        }
                    }
                } else if (trip.type === 'combo') {
                    // Check flight portion
                    let canAffordFlight = false;
                    const flightProg = trip.flight.program;
                    const flightPoints = trip.flight.points;

                    if ((balances[flightProg] || 0) >= flightPoints) {
                        canAffordFlight = true;
                        pointsSource.push(`${flightPoints.toLocaleString()} ${flightProg} miles`);
                    } else if (flightProg === 'ana' && (balances.amex || 0) >= flightPoints) {
                        canAffordFlight = true;
                        pointsSource.push(`Transfer ${flightPoints.toLocaleString()} Amex â†’ ANA`);
                    } else if ((balances.chase || 0) + (balances.amex || 0) >= flightPoints) {
                        canAffordFlight = true;
                        pointsSource.push(`Transfer from Chase/Amex`);
                    }

                    // Check hotel portion
                    let canAffordHotel = false;
                    const hotelProg = trip.hotel.program;
                    const hotelPoints = trip.hotel.points * trip.hotel.nights;

                    if ((balances[hotelProg] || 0) >= hotelPoints) {
                        canAffordHotel = true;
                        pointsSource.push(`${hotelPoints.toLocaleString()} ${hotelProg} points`);
                    } else if (hotelProg === 'hyatt' && (balances.chase || 0) >= hotelPoints) {
                        canAffordHotel = true;
                        pointsSource.push(`Transfer ${hotelPoints.toLocaleString()} Chase â†’ Hyatt`);
                    }

                    canAfford = canAffordFlight && canAffordHotel;
                    totalPointsNeeded = flightPoints + hotelPoints;
                }

                if (canAfford) {
                    affordableTrips.push({ ...trip, pointsSource, totalPointsNeeded });
                }
            }

            document.getElementById('alerts-trips-count').textContent = affordableTrips.length;

            // Render trip ideas
            const grid = document.getElementById('trip-ideas-grid');
            if (affordableTrips.length === 0) {
                grid.innerHTML = `
                    <div class="col-span-full text-center py-8 text-slate-500">
                        <i class="fas fa-suitcase-rolling text-4xl mb-3 text-slate-300"></i>
                        <p>Add more points to unlock trip ideas!</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = affordableTrips.map(trip => {
                const isAlertSet = activeAlerts.some(a => a.tripId === trip.id);
                const alertBtnClass = isAlertSet ? 'bg-green-100 text-green-700 border-green-300' : 'bg-white text-slate-700 border-slate-300 hover:border-brand-400';
                const alertBtnText = isAlertSet ? '<i class="fas fa-bell"></i> Alert Set' : '<i class="far fa-bell"></i> Set Alert';

                let typeIcon = '';
                let typeBadge = '';
                if (trip.type === 'hotel') {
                    typeIcon = '<i class="fas fa-hotel text-brand-500"></i>';
                    typeBadge = `<span class="text-xs bg-brand-100 text-brand-700 px-2 py-1 rounded-full">${trip.nightsMin} nights</span>`;
                } else if (trip.type === 'flight') {
                    typeIcon = '<i class="fas fa-plane text-purple-500"></i>';
                    typeBadge = `<span class="text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded-full">${trip.cabin}</span>`;
                } else {
                    typeIcon = '<i class="fas fa-suitcase text-amber-500"></i>';
                    typeBadge = `<span class="text-xs bg-amber-100 text-amber-700 px-2 py-1 rounded-full">Flight + Hotel</span>`;
                }

                // Get hotel/property name for display
                const propertyName = trip.hotel || (trip.type === 'combo' && trip.hotel?.name) || '';
                const hotelDisplay = propertyName ? `<p class="text-xs text-brand-600 font-medium mt-1">ðŸ¨ ${propertyName}</p>` : '';

                return `
                    <div class="bg-white rounded-2xl border border-slate-200 overflow-hidden card-hover">
                        <div class="bg-gradient-to-r from-slate-100 to-slate-50 p-4 border-b border-slate-100">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-3xl">${trip.image}</span>
                                ${typeBadge}
                            </div>
                            <h4 class="font-bold text-slate-900">${trip.title}</h4>
                            <p class="text-sm text-slate-500">${trip.destination}</p>
                            ${hotelDisplay}
                        </div>
                        <div class="p-4">
                            <p class="text-xs text-slate-500 mb-3">${trip.description}</p>
                            <div class="flex items-center justify-between mb-3">
                                <div>
                                    <p class="text-xs text-slate-400">Best time</p>
                                    <p class="font-semibold text-slate-900">${trip.month}</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-xs text-slate-400">Cash value</p>
                                    <p class="font-semibold text-green-600">$${(trip.cashValue || trip.totalValue).toLocaleString()}</p>
                                </div>
                            </div>
                            <div class="bg-slate-50 rounded-lg p-3 mb-3">
                                <p class="text-xs font-semibold text-slate-600 mb-1">How to book:</p>
                                <p class="text-xs text-slate-500">${trip.pointsSource.join(' + ')}</p>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="setTripAlert('${trip.id}')" class="flex-1 py-2 px-3 text-sm font-semibold rounded-lg border ${alertBtnClass} transition">
                                    ${alertBtnText}
                                </button>
                                <button onclick="bookTrip('${trip.id}')" class="py-2 px-3 text-sm font-semibold rounded-lg bg-green-500 text-white hover:bg-green-600 transition flex items-center gap-1">
                                    <i class="fas fa-external-link-alt text-xs"></i> Book Now
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function setTripAlert(tripId) {
            const existingIndex = activeAlerts.findIndex(a => a.tripId === tripId);

            if (existingIndex >= 0) {
                // Remove alert
                activeAlerts.splice(existingIndex, 1);
                showToast('Alert removed', 'info');
            } else {
                // Add alert
                const trip = tripIdeasDatabase.find(t => t.id === tripId);
                if (trip) {
                    activeAlerts.push({
                        tripId: tripId,
                        tripTitle: trip.title,
                        destination: trip.destination,
                        createdAt: new Date().toISOString(),
                        type: trip.type
                    });
                    showToast('ðŸ”” Alert set! We\'ll notify you of price drops.', 'success');
                }
            }

            localStorage.setItem('awardjetAlerts', JSON.stringify(activeAlerts));
            generateTripIdeas();
            renderActiveAlerts();
        }

        function renderActiveAlerts() {
            const container = document.getElementById('active-alerts-list');
            const noAlertsMsg = document.getElementById('no-alerts-message');

            document.getElementById('alerts-active-count').textContent = activeAlerts.length;

            if (activeAlerts.length === 0) {
                container.innerHTML = '';
                noAlertsMsg.classList.remove('hidden');
                return;
            }

            noAlertsMsg.classList.add('hidden');

            container.innerHTML = activeAlerts.map(alert => {
                const trip = tripIdeasDatabase.find(t => t.id === alert.tripId);
                const typeIcon = alert.type === 'hotel' ? 'fa-hotel text-brand-500' :
                                 alert.type === 'flight' ? 'fa-plane text-purple-500' : 'fa-suitcase text-amber-500';

                return `
                    <div class="flex items-center justify-between bg-white border border-slate-200 rounded-xl p-4">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center">
                                <i class="fas ${typeIcon}"></i>
                            </div>
                            <div>
                                <p class="font-semibold text-slate-900">${alert.tripTitle}</p>
                                <p class="text-sm text-slate-500">${alert.destination}</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="text-xs text-green-600 bg-green-50 px-2 py-1 rounded-full">
                                <i class="fas fa-bell mr-1"></i>Active
                            </span>
                            <button onclick="setTripAlert('${alert.tripId}')" class="text-slate-400 hover:text-red-500 transition">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderPriceDrops() {
            const container = document.getElementById('price-drops-list');

            container.innerHTML = priceDrops.map((drop, index) => {
                const dropPercent = Math.round((1 - drop.newPoints / drop.oldPoints) * 100);

                return `
                    <div class="bg-white border border-green-200 rounded-xl p-4 relative overflow-hidden">
                        <div class="absolute top-0 right-0 bg-green-500 text-white text-xs font-bold px-3 py-1 rounded-bl-lg">
                            -${dropPercent}%
                        </div>
                        <div class="flex items-start gap-4">
                            <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-arrow-trend-down text-green-600 text-xl"></i>
                            </div>
                            <div class="flex-1">
                                <h4 class="font-bold text-slate-900">${drop.route}</h4>
                                <p class="text-sm text-slate-500">${drop.program} â€¢ ${drop.cabin} â€¢ ${drop.date}</p>
                                <div class="flex items-center justify-between mt-2">
                                    <div class="flex items-center gap-2">
                                        <span class="text-slate-400 line-through text-sm">${drop.oldPoints.toLocaleString()}</span>
                                        <span class="text-green-600 font-bold">${drop.newPoints.toLocaleString()} pts</span>
                                        <span class="text-xs text-green-600 bg-green-50 px-2 py-0.5 rounded-full">${drop.savings}</span>
                                    </div>
                                    <button onclick="bookPriceDrop(${index})" class="px-3 py-1.5 text-xs font-semibold rounded-lg bg-green-500 text-white hover:bg-green-600 transition flex items-center gap-1">
                                        <i class="fas fa-external-link-alt"></i> Book
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function bookPriceDrop(index) {
            const drop = priceDrops[index];
            if (!drop || !drop.bookingUrl) {
                showToast('Booking link not available', 'error');
                return;
            }
            showToast(`ðŸŽ« Opening ${drop.program} booking for ${drop.route}...`, 'success');
            window.open(drop.bookingUrl, '_blank');
        }

        function bookTrip(tripId) {
            const trip = tripIdeasDatabase.find(t => t.id === tripId);
            if (!trip) return;

            // Get the booking URL
            let bookingUrl = trip.bookingUrl;

            if (!bookingUrl) {
                // Fallback to program's general booking URL
                const program = trip.program || (trip.flight && trip.flight.program) || (trip.hotel && trip.hotel.program);
                bookingUrl = bookingUrls[program] || '#';
            }

            // Show toast and open booking page
            showToast(`ðŸŽ« Opening ${trip.title} booking page...`, 'success');

            // Open in new tab
            window.open(bookingUrl, '_blank');
        }

        function viewTripDetails(tripId) {
            const trip = tripIdeasDatabase.find(t => t.id === tripId);
            if (!trip) return;
            showToast(`Viewing details for ${trip.title} - ${trip.destination}`, 'info');
        }

        function refreshTripIdeas() {
            showToast('Refreshing trip ideas...', 'info');
            generateTripIdeas();
        }

        function saveAlertPreferences() {
            const email = document.getElementById('alert-email').value;
            const frequency = document.getElementById('alert-frequency').value;
            const priceDrops = document.getElementById('alert-price-drops').checked;
            const tripIdeas = document.getElementById('alert-trip-ideas').checked;
            const expiring = document.getElementById('alert-expiring').checked;

            const prefs = { email, frequency, priceDrops, tripIdeas, expiring };
            localStorage.setItem('awardjetAlertPrefs', JSON.stringify(prefs));

            showToast('âœ… Alert preferences saved!', 'success');
        }

        function loadAlertPreferences() {
            const saved = localStorage.getItem('awardjetAlertPrefs');
            if (saved) {
                const prefs = JSON.parse(saved);
                if (prefs.email) document.getElementById('alert-email').value = prefs.email;
                if (prefs.frequency) document.getElementById('alert-frequency').value = prefs.frequency;
                document.getElementById('alert-price-drops').checked = prefs.priceDrops !== false;
                document.getElementById('alert-trip-ideas').checked = prefs.tripIdeas !== false;
                document.getElementById('alert-expiring').checked = prefs.expiring !== false;
            }
        }

        function initAlerts() {
            generateTripIdeas();
            renderActiveAlerts();
            renderPriceDrops();
            loadAlertPreferences();
        }

        // ============================================
        // INIT
        // ============================================

        document.addEventListener('DOMContentLoaded', () => {
            const future = new Date();
            future.setMonth(future.getMonth() + 2);
            document.getElementById('travel-date').value = future.toISOString().split('T')[0];
            if (userState.isLoggedIn) {
                document.getElementById('login-btn').innerHTML = `<i class="fas fa-user-circle mr-2"></i>${userState.email?.split('@')[0] || 'User'}`;
            }
            loadSavedPortfolio();
            searchFlights();
            initAlerts();
        });

        document.getElementById('auth-modal').addEventListener('click', e => { if (e.target.id === 'auth-modal') closeAuth(); });
        document.getElementById('booking-modal').addEventListener('click', e => { if (e.target.id === 'booking-modal') closeBookingModal(); });
    </script>
</body>
</html>

